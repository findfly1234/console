<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.allcheer.bpos.mapper.TblMerAuditRecordVOMapper">

    <resultMap id="BaseResultMap" type="com.allcheer.bpos.entity.vo.TblMerAuditRecordVO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="MER_ID" property="merId" jdbcType="VARCHAR"/>
        <result column="MER_NAME" property="merName" jdbcType="VARCHAR"/>
        <result column="MER_STAT" property="merStat" jdbcType="VARCHAR"/>
        <result column="AUDIT_RESULT" property="auditResult" jdbcType="VARCHAR"/>
        <result column="REMARK" property="remark" jdbcType="VARCHAR"/>
        <result column="ERROR_FIELD" property="errorFields" jdbcType="VARCHAR"/>
        <result column="CONTACT_MOBILE" property="phone" jdbcType="VARCHAR"/>
        <result column="USER_NAME" property="userName" jdbcType="VARCHAR"/>
        <result column="CREATE_TIME" property="applyAt" jdbcType="VARCHAR"/>
        <result column="AUDIT_TIME" property="lastAt" jdbcType="VARCHAR"/>
        <result column="AUDIT_ID" property="auditId" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        O.MER_ID, O.MER_NAME,O.REG_NAME, O.REG_SHORT_NAME, O.MER_STAT, O.FUNC_STAT, O.MER_TYPE,
        O.MER_ADDRESS,
        O.REG_FUNDS, O.BUS_LIC_NM, O.BUS_LIC_EXPIRE, O.TAX_REG_CERT, O.LEGAL_PERSON, O.LEGAL_PERSON_CERT_TYPE,
        O.LEGAL_PERSON_CERT_NM, O.LEGAL_PERSON_CERT_EXPIRE, O.CONTACT_PERSON, O.CONTACT_MOBILE, O.CONTACT_EMAIL,
        O.ATTACHMENT_PATH,O.UPDATE_TIME,A.REMARK,A.USER_NAME,A.CREATE_TIME,A.ERROR_FIELD,A.CREATE_TIME AS AUDIT_TIME,A.AUDIT_ID,A.AUDIT_RESULT
    </sql>


    <select id="countByCondition" parameterType="map" resultType="java.lang.Integer">

        select count(*) from TBL_MER_AUDIT_RECORD A inner join TBL_MER_INFO O on A.MER_ID =
        O.MER_ID where 1=1
        <if test="phone != null and phone!=''">
            and O.CONTACT_MOBILE like '%'||#{phone}||'%'
        </if>
        <if test="merName != null and merName!='' ">
            and O.MER_NAME like '%'||#{merName}||'%'
        </if>
        <if test="merId != null and merId!='' ">
            and O.MER_ID = #{merId}
        </if>
        <if test="applyStartAt != null ">
            and O.CREATE_TIME &gt;= #{applyStartAt}
        </if>
        <if test="applyEndAt != null ">
            and O.CREATE_TIME &lt;= #{applyEndAt}
        </if>
        <if test="auditResult != null ">
            and A.AUDIT_RESULT = #{auditResult}
        </if>

    </select>

    <select id="selectByCondition" parameterType="map" resultMap="BaseResultMap">

        select

        <include refid="Base_Column_List"/>

        from TBL_MER_AUDIT_RECORD A inner join TBL_MER_INFO O on A.MER_ID =
        O.MER_ID where 1=1
        <if test="phone != null and phone!=''">
            and O.CONTACT_MOBILE like '%'||#{phone}||'%'
        </if>
        <if test="merName != null and merName!='' ">
            and O.MER_NAME like '%'||#{merName}||'%'
        </if>
        <if test="merId != null and merId!='' ">
            and O.MER_ID =#{merId}
        </if>
        <if test="applyStartAt != null ">
            and O.CREATE_TIME &gt;= #{applyStartAt}
        </if>
        <if test="applyEndAt != null ">
            and O.CREATE_TIME &lt;= #{applyEndAt}
        </if>
        <if test="auditResult != null ">
            and A.AUDIT_RESULT = #{auditResult}
        </if>
        order by A.CREATE_TIME DESC
    </select>

</mapper>