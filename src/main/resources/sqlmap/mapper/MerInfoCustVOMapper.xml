<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.allcheer.bpos.mapper.MerInfoCustVOMapper">

    <resultMap id="BaseResultMap" type="com.allcheer.bpos.entity.vo.TblMerInfoVO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="MER_ID" property="merId" jdbcType="VARCHAR"/>
        <result column="MER_NAME" property="merName" jdbcType="VARCHAR"/>
        <result column="TERM_ID" property="termId" jdbcType="VARCHAR"/>
        <result column="INST_ID" property="instId" jdbcType="CHAR"/>
        <result column="INST_MER_ID" property="instMerId" jdbcType="VARCHAR"/>
        <result column="INST_TERM_ID" property="instTermId" jdbcType="VARCHAR"/>
        <result column="REG_NAME" property="regName" jdbcType="VARCHAR"/>
        <result column="REG_SHORT_NAME" property="regShortName" jdbcType="VARCHAR"/>
        <result column="MER_STAT" property="merStat" jdbcType="CHAR"/>
        <result column="FUNC_STAT" property="funcStat" jdbcType="CHAR"/>
        <result column="MER_TYPE" property="merType" jdbcType="CHAR"/>
        <result column="MER_ADDRESS" property="merAddress" jdbcType="VARCHAR"/>
        <result column="REG_FUNDS" property="regFunds" jdbcType="VARCHAR"/>
        <result column="BUS_LIC_NM" property="busLicNm" jdbcType="VARCHAR"/>
        <result column="BUS_LIC_EXPIRE" property="busLicExpire" jdbcType="CHAR"/>
        <result column="TAX_REG_CERT" property="taxRegCert" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON_CERT_TYPE" property="legalPersonCertType" jdbcType="CHAR"/>
        <result column="LEGAL_PERSON_CERT_NM" property="legalPersonCertNm" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON_CERT_EXPIRE" property="legalPersonCertExpire" jdbcType="CHAR"/>
        <result column="CONTACT_PERSON" property="contactPerson" jdbcType="VARCHAR"/>
        <result column="CONTACT_MOBILE" property="contactMobile" jdbcType="VARCHAR"/>
        <result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR"/>
        <result column="ATTACHMENT_PATH" property="attachmentPath" jdbcType="VARCHAR"/>
        <result column="USER_NAME" property="userName" jdbcType="VARCHAR"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="CHAR"/>
        <result column="REPORT_STATUS" property="reportStatus" jdbcType="VARCHAR"/>
        <result column="CREATE_TIME" property="createTime" jdbcType="CHAR"/>
        <result column="POS_MER_ID" property="posMerId" jdbcType="CHAR"/>
    </resultMap>

    <resultMap id="BaseAgentResultMap" type="com.allcheer.bpos.entity.vo.TblAgentMerInfoVO">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="MER_ID" property="merId" jdbcType="VARCHAR"/>
        <result column="MER_NAME" property="merName" jdbcType="VARCHAR"/>
        <result column="TERM_ID" property="termId" jdbcType="VARCHAR"/>
        <result column="AGENT_ID" property="agentId" jdbcType="CHAR"/>
        <result column="REG_NAME" property="regName" jdbcType="VARCHAR"/>
        <result column="REG_SHORT_NAME" property="regShortName" jdbcType="VARCHAR"/>
        <result column="MER_STAT" property="merStat" jdbcType="CHAR"/>
        <result column="GATE_BIND_STAT" property="gateBindStat" jdbcType="CHAR"/>
        <result column="FUNC_STAT" property="funcStat" jdbcType="CHAR"/>
        <result column="MER_TYPE" property="merType" jdbcType="CHAR"/>
        <result column="MER_ADDRESS" property="merAddress" jdbcType="VARCHAR"/>
        <result column="REG_FUNDS" property="regFunds" jdbcType="VARCHAR"/>
        <result column="BUS_LIC_NM" property="busLicNm" jdbcType="VARCHAR"/>
        <result column="BUS_LIC_EXPIRE" property="busLicExpire" jdbcType="CHAR"/>
        <result column="TAX_REG_CERT" property="taxRegCert" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON_CERT_TYPE" property="legalPersonCertType" jdbcType="CHAR"/>
        <result column="LEGAL_PERSON_CERT_NM" property="legalPersonCertNm" jdbcType="VARCHAR"/>
        <result column="LEGAL_PERSON_CERT_EXPIRE" property="legalPersonCertExpire" jdbcType="CHAR"/>
        <result column="CONTACT_PERSON" property="contactPerson" jdbcType="VARCHAR"/>
        <result column="CONTACT_MOBILE" property="contactMobile" jdbcType="VARCHAR"/>
        <result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR"/>
        <result column="ATTACHMENT_PATH" property="attachmentPath" jdbcType="VARCHAR"/>
        <result column="USER_NAME" property="userName" jdbcType="VARCHAR"/>
        <result column="UPDATE_TIME" property="updateTime" jdbcType="CHAR"/>
        <result column="AGENT_SHORT_NAME" property="agentShortName" jdbcType="VARCHAR" />
        <result column="REPORT_STATUS" property="reportStatus" jdbcType="VARCHAR" />
    </resultMap>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        O.MER_ID, O.MER_NAME,L.INST_ID,L.INST_MER_ID,L.INST_TERM_ID, L.TERM_ID,O.REG_NAME, O.REG_SHORT_NAME, O.MER_STAT, O.FUNC_STAT, O.MER_TYPE,
        O.MER_ADDRESS,
        O.REG_FUNDS, O.BUS_LIC_NM, O.BUS_LIC_EXPIRE, O.TAX_REG_CERT, O.LEGAL_PERSON, O.LEGAL_PERSON_CERT_TYPE,
        O.LEGAL_PERSON_CERT_NM, O.LEGAL_PERSON_CERT_EXPIRE, O.CONTACT_PERSON, O.CONTACT_MOBILE, O.CONTACT_EMAIL,
        O.ATTACHMENT_PATH, O.USER_NAME,O.CREATE_TIME,O.UPDATE_TIME, O.REPORT_STATUS, B.POS_MER_ID
    </sql>

    <sql id="Base_Agent_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        O.MER_ID, O.MER_NAME,L.AGENT_ID,L.TERM_ID,O.REG_NAME, O.REG_SHORT_NAME, O.MER_STAT, O.FUNC_STAT, O.MER_TYPE,
        O.MER_ADDRESS,L.GATE_BIND_STAT,
        O.REG_FUNDS, O.BUS_LIC_NM, O.BUS_LIC_EXPIRE, O.TAX_REG_CERT, O.LEGAL_PERSON, O.LEGAL_PERSON_CERT_TYPE,
        O.LEGAL_PERSON_CERT_NM, O.LEGAL_PERSON_CERT_EXPIRE, O.CONTACT_PERSON, O.CONTACT_MOBILE, O.CONTACT_EMAIL,
        O.ATTACHMENT_PATH, O.USER_NAME,O.CREATE_TIME,O.UPDATE_TIME, A.AGENT_SHORT_NAME, O.REPORT_STATUS
    </sql>


    <select id="countMerInfo" resultType="java.lang.Integer" parameterType="java.util.Map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
          COUNT (*)
        from TBL_MER_INFO O,TBL_INST_MER_TERM_REL L
        where
        O.MER_ID = L.MER_ID
        <if test="merId != null">
            AND O.MER_ID = #{merId,jdbcType=VARCHAR}
        </if>
        <if test="merName != null">
            AND O.MER_NAME like  concat(concat('%',#{merName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="merStat != null">
            AND O.MER_STAT = #{merStat,jdbcType=CHAR}
        </if>
        <if test="instId != null">
            AND L.INST_ID = #{instId,jdbcType=VARCHAR}
        </if>
        <if test="instMerId != null">
            AND L.INST_MER_ID = #{instMerId,jdbcType=VARCHAR}
        </if>
        <if test="instTermId != null">
            AND L.INST_TERM_ID = #{instTermId,jdbcType=VARCHAR}
        </if>
        <if test="startTime != null">
            AND O.UPDATE_TIME &gt;= #{startTime,jdbcType=CHAR}
        </if>
        <if test="endTime != null">
            AND O.UPDATE_TIME &lt;= #{endTime,jdbcType=CHAR}
        </if>
    </select>


    <select id="queryMerInfo" resultMap="BaseResultMap" parameterType="java.util.Map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from TBL_MER_INFO O,TBL_INST_MER_TERM_REL L left join TBL_BANK_POS_INFO B on L.INST_ID = B.INST_ID
        where
        O.MER_ID = L.MER_ID
        <if test="merId != null">
            AND O.MER_ID = #{merId,jdbcType=VARCHAR}
        </if>
        <if test="merName != null">
            AND O.MER_NAME like  concat(concat('%',#{merName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="merStat != null">
            AND O.MER_STAT = #{merStat,jdbcType=CHAR}
        </if>
        <if test="instId != null">
            AND L.INST_ID = #{instId,jdbcType=VARCHAR}
        </if>
        <if test="instMerId != null">
            AND L.INST_MER_ID = #{instMerId,jdbcType=VARCHAR}
        </if>
        <if test="instTermId != null">
            AND L.INST_TERM_ID = #{instTermId,jdbcType=VARCHAR}
        </if>
        <if test="startTime != null">
            AND O.UPDATE_TIME &gt;= #{startTime,jdbcType=CHAR}
        </if>
        <if test="endTime != null">
            AND O.UPDATE_TIME &lt;=  #{endTime,jdbcType=CHAR}
        </if>
    </select>

    <select id="queryAgentMerInfo" resultMap="BaseAgentResultMap" parameterType="java.util.Map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Agent_Column_List"/>
        from TBL_MER_INFO O,TBL_AGENT_MER_TERM_REL L, TBL_AGENT_INFO A
        where
        O.MER_ID = L.MER_ID AND 
        L.AGENT_ID = A.MEMBER_ID
        <if test="merId != null">
            AND O.MER_ID = #{merId,jdbcType=VARCHAR}
        </if>
        <if test="merName != null">
            AND O.MER_NAME like  concat(concat('%',#{merName,jdbcType=VARCHAR}),'%')
        </if>
        <if test="merStat != null">
            AND O.MER_STAT = #{merStat,jdbcType=CHAR}
        </if>
        <if test="agentId != null">
            AND L.AGENT_ID = #{agentId,jdbcType=VARCHAR}
        </if>
        <if test="startTime != null">
            AND O.UPDATE_TIME &gt;= #{startTime,jdbcType=CHAR}
        </if>
        <if test="endTime != null">
            AND O.UPDATE_TIME &lt;=  #{endTime,jdbcType=CHAR}
        </if>
        <if test="termIsNotNull != null">
            AND L.TERM_ID IS NOT NULL
        </if>
    </select>

    <select id="countAgentMerInfo" resultType="java.lang.Integer" parameterType="java.util.Map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        COUNT (*)
        from TBL_MER_INFO O,TBL_AGENT_MER_TERM_REL L
        where
        O.MER_ID = L.MER_ID
        <if test="merId != null">
            AND O.MER_ID = #{merId,jdbcType=VARCHAR}
        </if>
        <if test="merName != null">
            AND O.MER_NAME like concat(concat('%',#{merName}),'%')
        </if>
        <if test="merStat != null">
            AND O.MER_STAT = #{merStat,jdbcType=CHAR}
        </if>
        <if test="agentId != null">
            AND L.AGENT_ID = #{agentId,jdbcType=VARCHAR}
        </if>
        <if test="startTime != null">
            AND O.UPDATE_TIME &gt;= #{startTime,jdbcType=CHAR}
        </if>
        <if test="endTime != null">
            AND O.UPDATE_TIME &lt;= #{endTime,jdbcType=CHAR}
        </if>
        <if test="termIsNotNull != null">
            AND L.TERM_ID IS NOT NULL
        </if>
    </select>
</mapper>